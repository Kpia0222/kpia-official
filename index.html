<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kpia Official</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body,html{width:100%;height:100%;overflow:hidden;font-family:'Arial',sans-serif;background-color:#111;}

#background{position:fixed;top:0;left:0;width:100%;height:100%;background:url('assets/background.png') center/cover no-repeat;filter:blur(8px) brightness(0.6);opacity:0;transition:opacity 5s ease;}

#noise{position:fixed;top:0;left:0;width:100%;height:100%;background:url('assets/noise.png') repeat;opacity:0.1;pointer-events:none;}
#metallic{position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(120deg, rgba(255,255,255,0.05), rgba(255,255,255,0.2), rgba(255,255,255,0.05));background-size:200% 200%;animation:shine 6s linear infinite;pointer-events:none;}
@keyframes shine{0%{background-position:0% 0%;}100%{background-position:100% 100%;}}

canvas#waveCanvas{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;opacity:0.2;}

.geo{position:absolute;border:1px solid rgba(255,255,255,0.2);opacity:0.5;pointer-events:none;animation:geoAnim 10s linear infinite;}
@keyframes geoAnim{0%{transform:rotate(0deg) scale(1);}50%{transform:rotate(180deg) scale(1.2);}100%{transform:rotate(360deg) scale(1);}}

#icon{position:absolute;top:50%;left:50%;width:150px;height:150px;transform:translate(-50%,-50%);background:url('assets/logo.png') center/contain no-repeat;opacity:0;transition:opacity 5s ease;cursor:pointer;border-radius:50%;box-shadow:0 0 30px rgba(255,255,255,0.5);}
@media(min-width:768px){#icon{width:180px;height:180px;}}@media(max-width:767px){#icon{width:120px;height:120px;}}

/* グリッチ */
#icon.glitch::before,#icon.glitch::after{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background:url('assets/logo.png') center/contain no-repeat;mix-blend-mode:screen;opacity:0.7;}
#icon.glitch::before{left:2px;clip:rect(0,150px,50px,0);animation:glitchTop 2s infinite linear;}
#icon.glitch::after{left:-2px;clip:rect(50px,150px,150px,0);animation:glitchBottom 3s infinite linear;}
@keyframes glitchTop{0%{transform:translate(0,0);}20%{transform:translate(-2px,2px);}40%{transform:translate(2px,-2px);}60%{transform:translate(-2px,1px);}80%{transform:translate(1px,-1px);}100%{transform:translate(0,0);}}
@keyframes glitchBottom{0%{transform:translate(0,0);}20%{transform:translate(2px,-2px);}40%{transform:translate(-2px,2px);}60%{transform:translate(2px,-1px);}80%{transform:translate(-1px,1px);}100%{transform:translate(0,0);}}
</style>
</head>
<body>
<div id="background"></div>
<div id="noise"></div>
<div id="metallic"></div>
<canvas id="waveCanvas"></canvas>
<div id="icon" class="glitch"></div>

<script>
const icon=document.getElementById('icon');
const canvas=document.getElementById('waveCanvas');
const ctx=canvas.getContext('2d');
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;

// フェードイン
window.addEventListener('load',()=>{
  document.getElementById('background').style.opacity='1';
  document.getElementById('icon').style.opacity='1';
  animateFloat();
  createGeoShapes(10);
  animateWaves();
  createParticles();
});

// 流体的浮遊
function animateFloat(){
  let angle=0,radius=20;
  function float(){
    angle+=0.02;
    let x=Math.sin(angle)*radius;
    let y=Math.cos(angle)*radius;
    icon.style.transform=`translate(-50%,-50%) translate(${x}px,${y}px)`;
    requestAnimationFrame(float);
  }
  float();
}

// マウス追従
document.addEventListener('mousemove',(e)=>{
  const rect=icon.getBoundingClientRect();
  const iconX=rect.left+rect.width/2;
  const iconY=rect.top+rect.height/2;
  const dx=e.clientX-iconX;
  const dy=e.clientY-iconY;
  const distance=Math.sqrt(dx*dx+dy*dy);
  const maxDistance=150;
  let offsetX=0,offsetY=0;
  if(distance<maxDistance){
    const factor=(maxDistance-distance)/maxDistance;
    offsetX=dx*0.2*factor;
    offsetY=dy*0.2*factor;
  }
  icon.style.transform=`translate(-50%,-50%) translate(${offsetX}px,${offsetY}px)`;
});

// 幾何学オーバーレイ
function createGeoShapes(count){
  for(let i=0;i<count;i++){
    let div=document.createElement('div');
    div.className='geo';
    div.style.width=div.style.height=(50+Math.random()*100)+'px';
    div.style.top=Math.random()*100+'%';
    div.style.left=Math.random()*100+'%';
    div.style.borderRadius=Math.random()*50+'%';
    div.style.animationDuration=(5+Math.random()*5)+'s';
    document.body.appendChild(div);
  }
}

// 背景波紋
let waveTime=0;
function animateWaves(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  let numWaves=5;
  for(let i=0;i<numWaves;i++){
    ctx.beginPath();
    let amplitude=10+5*i;
    let frequency=0.01+0.002*i;
    ctx.strokeStyle='rgba(255,255,255,0.02)';
    ctx.lineWidth=2;
    for(let x=0;x<canvas.width;x++){
      let y=canvas.height/2 + Math.sin(x*frequency+waveTime+i) * amplitude;
      if(x===0){ctx.moveTo(x,y);}else{ctx.lineTo(x,y);}
    }
    ctx.stroke();
  }
  waveTime+=0.05;
  requestAnimationFrame(animateWaves);
}

// パーティクル
let particles=[];
function createParticles(){
  for(let i=0;i<50;i++){
    particles.push({
      x:icon.offsetLeft+icon.offsetWidth/2,
      y:icon.offsetTop+icon.offsetHeight/2,
      angle:Math.random()*2*Math.PI,
      radius:Math.random()*50+30,
      size:Math.random()*3+1,
      speed:0.02+Math.random()*0.03,
      alpha:Math.random()*0.5+0.5
    });
  }
  requestAnimationFrame(animateParticles);
}

function animateParticles(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  // 波紋も描画
  animateWavesFrame();
  for(let p of particles){
    p.angle+=p.speed;
    let px=icon.offsetLeft+icon.offsetWidth/2 + Math.cos(p.angle)*p.radius;
    let py=icon.offsetTop+icon.offsetHeight/2 + Math.sin(p.angle)*p.radius;
    ctx.beginPath();
    ctx.arc(px,py,p.size,0,Math.PI*2);
    ctx.fillStyle=`rgba(255,255,255,${p.alpha})`;
    ctx.fill();
  }
  requestAnimationFrame(animateParticles);
}

// 波紋描画のみ（パーティクルと同時）
function animateWavesFrame(){
  let numWaves=5;
  for(let i=0;i<numWaves;i++){
    ctx.beginPath();
    let amplitude=10+5*i;
    let frequency=0.01+0.002*i;
    ctx.strokeStyle='rgba(255,255,255,0.02)';
    ctx.lineWidth=2;
    for(let x=0;x<canvas.width;x++){
      let y=canvas.height/2 + Math.sin(x*frequency+waveTime+i) * amplitude;
      if(x===0){ctx.moveTo(x,y);}else{ctx.lineTo(x,y);}
    }
    ctx.stroke();
  }
  waveTime+=0.05;
}
</script>
</body>
</html>
